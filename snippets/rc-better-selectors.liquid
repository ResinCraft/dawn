<script type="text/javascript">
    var productOptionNames = [];
    var productOptionValues = [];
    {% for product_option in product.options_with_values %}
        productOptionNames.push("{{ product_option.name | replace: '"', '\\"' }}");
        productOptionValues[{{ forloop.index | minus:1 }}] =  new Array();
        {% for value in product_option.values %}
            productOptionValues[{{ forloop.parentloop.index | minus:1 }}].push("{{ value | replace: '"', '\\"' }}");
        {% endfor %}
    {% endfor %}  
    //console.log('productOptionNames: '+productOptionNames);
    //console.log('productOptionValues: '+productOptionValues[0,1,2]);
    
    function setDefaultOption(select,optionName)
    {
        optionText = "Select " + optionName + "..."

        //build the option that is going to be inserted into the drop down box
        var option = document.createElement("option");
        option.text = optionText;

        //only trigger this option if there is no pre-selected variant. i.e. the url doesn't have a "?variant=1234" value.
        const urlParams = new URLSearchParams(window.location.search);
        if(!urlParams.has('variant')) {
            option.selected = true;
        }

        //add the option to the selector at the top
        select.add(option, select[0]);
    }

    function modifySelect(select)
    {
        selectName = selectObject.name;
        optionText = selectName.match(/\[(.*?)\]/)[1];
        index = productOptionNames.indexOf(optionText);
        console.log('index: '+index);
    }

    const selects = document.getElementsByClassName("select__select");
    Array.prototype.forEach.call(selects, function(select, i) {
        setDefaultOption(select,productOptionNames[i]);
        modifySelect(select);
    });
</script>