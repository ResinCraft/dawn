<script type="text/javascript">

	function msgText(stockLevel) {
		var text = "Sold out!";
        if(stockLevel > 10) {
          text = "More than 10 available";
        } else {
          text = "Only " + stockLevel + " left!";
        }
        return text;
    }
  
    var variant = [];
    {% for variant in product.variants %}
  		variant.push({id:{{ variant.id }}, option1:'{{ variant.option1 }}', option2:'{{ variant.option2 }}', option3:'{{ variant.option3 }}', stock:'{{ variant.inventory_quantity }}'});
    {% endfor %}

	if(typeof document.getElementById('stock-level') !== 'undefined')
		{
			var element = document.getElementById('stock-level');
		} else {
			const elem = document.createElement('p');
			elementArray = document.getElementsByClassName("product-form__input product-form__quantity");
			target.parentNode.insertBefore(elem, elementArray[0]);
  		}
                      
    this.addEventListener('change', this.onVariantChange);
    function onVariantChange() 
	{
		var selectObjects = document.getElementsByClassName('select__select');
		var filterItems = {};
  		Array.prototype.forEach.call(selectObjects, function(selectObject, i) {
    		var itemString = "option"+(i+1);
    		filterItems[itemString] = selectObject.value;
  		});

        result = variant.filter(function(item) {
          for (var key in filterItems) {
            if (item[key] === undefined || item[key] != filterItems[key])
              return false;
          }
          return true;
        });
  		
  		if(typeof result[0] !== 'undefined'){
			var msg = msgText(result[0].stock);
          	element.innerHTML = msg;
        } else {
          	element.innerHTML = '';
        }
        
	}
</script>