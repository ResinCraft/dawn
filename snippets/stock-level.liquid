<ul class="list" id="stock-levels">  
  {% for variant in product.variants %}
  	<li id="stock-level-{{ variant.id }}" style="display:none;">{{ variant.title }} - {{ variant.inventory_quantity }}</li>
  {% endfor %}
</ul>
{{ 'option_selection.js' | shopify_asset_url | script_tag }}
<script type="text/javascript">
  this.addEventListener('change', this.onVariantChange);
  
  function onVariantChange() {
    const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);
    const variant = urlParams.get('variant');
    let lis = document.getElementById('stock-levels').getElementsByTagName('li');
    
    lis.forEach(updateStockLevels);

    function updateStockLevels(listItem) {
      var element = document.getElementById('stock-level-' + variant.toString());
      //console.log(listItem.id + ' == ' + variant)
	  if(urlParams.has('variant') && listItem.id.toString() == ('stock-level-' + variant)) {
        console.log(element)
        element.style.display = null;
      } else {
        element.style.display = "none";
      }
    }
  }
</script>